<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>drotr • drotr</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="drotr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drotr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/drotr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/allicodi/drotr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>drotr</h1>
                        <h4 data-toc-skip class="author"><div class="line-block">Allison Codi<br><a href="mailto:allison.codi@emory.edu" class="email">allison.codi@emory.edu</a>
</div></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/allicodi/drotr/blob/master/vignettes/drotr.Rmd" class="external-link"><code>vignettes/drotr.Rmd</code></a></small>
      <div class="d-none name"><code>drotr.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Optimal treatment rules (OTRs) are decision-making policies
      that assign treatment based on an individual’s observed
      characteristics in a way that maximizes their expected outcome.
      While many methods exist for the creation of such rules, we
      propose a novel framework that creates treatment recommendations
      conditional on a subset of available information and constrains
      these recommendations to individuals with a clinically relevant
      conditional average treatment effect (CATE). We make use of a
      nested cross-validation procedure with Super Learning to estimate
      a doubly robust (DR)-learner and recommend treatment to patients
      whose predicted treatment effect meets the pre-set threshold. We
      then use an augmented inverse probability of treatment weighted
      estimator (AIPTW) to estimate several quantities describing
      outcomes under the OTR: (1) the proportion treated, (2) the
      overall Average Treatment effect under the Rule
      (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATR_d</annotation></semantics></math>),
      (3) the Average Treatment effect in the subgroup Recommended
      Treatment under the rule
      (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>),
      (4) the Average Treatment effect in the subgroup Not Recommended
      Treatment under the rule
      (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATNRT_d</annotation></semantics></math>),
      and (5) the difference between treatment recommendation subgroups
      (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub><mo>−</mo><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d - ATNRT_d</annotation></semantics></math>).
      The doubly-robust properties of the DR-learner and AIPTW ensure
      accurate estimation of the CATE and estimands of interest if some
      combination of nuisance parameters used to build them are
      consistently estimated. The vignette provides a brief introduction
      to the <code>drotr</code> package and demonstrates its use on a
      simulated dataset.</p>
    </div>
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<!--- note this is taken almost exactly from rewritten intro of paper, maybe need to modify more? --->
<p>Optimal treatment rules (OTRs) are policies that assign treatment
based on an individual’s observed characteristics to maximize the
counterfactual outcome of individual patients. OTRs are of increasing
interest in fields like healthcare given treatments can have varying
effects across population subgroups. While there are many ways to define
OTRs, one estimand commonly used is the Conditional Average Treatment
Effect (CATE). The CATE measures the expected difference in
counterfactual outcome between different treatments given a subset of
covariates. CATE estimation often relies on assumptions that, if
violated, can lead to inaccurate results. Additionally, recommending
treatment to all individuals with a CATE indicating they benefit from
treatment may not be practical due to challenges such as resource
limitations or population-level consequences of overprescribing.</p>
<p>We overcome these challenges through a doubly-robust method for
learning OTRs and estimating average treatment effects under the rules.
Our OTRs are constrained to assign treatment to individuals with a
clinically relevant treatment effect size. We use a doubly robust
(DR)-learner to estimate the CATE, ensuring accurate estimation if at
least some combination of nuisance parameters are consistently estimated
<span class="citation">(Kennedy 2023)</span>. A Super Learner ensemble
is used to optimally combine candidate models for treatment rule
estimation in a way that minimizes cross-validated risk and uncovers
treatment effect heterogeneity more effectively than traditional
approaches <span class="citation">(Luedtke and Laan 2016)</span>, <span class="citation">(Montoya et al. 2023)</span>. Given treatment decisions
made under the OTR, we identify the following quantities to describe
outcomes under the OTR: (1) the proportion treated, (2) the Average
Treatment effect of the Rule
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATR_d</annotation></semantics></math>),
(3) the Average Treatment effect in the subgroup Recommended Treatment
under the rule
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>),
(4) the Average Treatment effect in the subgroup Not Recommended
Treatment under the rule
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATNRT_d</annotation></semantics></math>),
and (5) the difference between subgroups. We estimate these quantities
using the augmented inverse probability of treatment weighted estimator
(AIPTW) to maintain the doubly-robust property in line with the CATE
<span class="citation">(Kurz 2022)</span>. We can compare expected
outcomes under different OTRs to identify which covariates are most
informative and thus should be focused on in policymaking. Our method is
unbiased and has 95% confidence interval coverage of data-adaptive
parameters.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>∈</mo><mi>𝒲</mi></mrow><annotation encoding="application/x-tex">W \in \mathcal{W}</annotation></semantics></math>
denote the full set of covariates in the data. We then consider a subset
of these covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
to create our OTR such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">Z \subseteq W</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">A \in \{0,1\}</annotation></semantics></math>
be a binary treatment decision in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A = 1</annotation></semantics></math>
if an observation is assigned treatment and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A = 0</annotation></semantics></math>
otherwise. Lastly, let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∈</mo><mi>𝒴</mi></mrow><annotation encoding="application/x-tex">Y \in \mathcal{Y}</annotation></semantics></math>
be a real-valued outcome variable. We denote missingness in outcome
variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Delta \in \{0,1\}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Delta = 0</annotation></semantics></math>
if the outcome is missing and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Delta = 1</annotation></semantics></math>
if the outcome is observed. We observe an independent and identically
distributed (i.i.d) sample of observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>W</mi><mi>i</mi></msub><mo>,</mo><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><msub><mi>Y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>P</mi><mn>0</mn></msub><mo>∈</mo><mi>𝒫</mi></mrow><annotation encoding="application/x-tex">O_i = (W_i, A_i,\Delta_i, \Delta_iY_i) \sim P_0 \in \mathcal{P}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math>
is an unknown distribution in model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒫</mi><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math>.</p>
<p>We introduce counterfactual outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>Δ</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>P</mi><mrow><mn>0</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>Δ</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Y(a, \Delta = 1) \sim P_{0, a, \Delta = 1}</annotation></semantics></math>
for every treatment assignment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒶</mi><mo mathvariant="script">∈</mo><mi>𝒜</mi></mrow><annotation encoding="application/x-tex">\mathcal{a \in A}</annotation></semantics></math>.
The counterfactual outcome represents the outcome that would have been
observed if, perhaps contrary to actual assignments, each observation
was assigned to treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒶</mi><annotation encoding="application/x-tex">\mathcal{a}</annotation></semantics></math>
and no outcomes were missing.</p>
</div>
<div class="section level3">
<h3 id="parameters-of-interest">Parameters of Interest<a class="anchor" aria-label="anchor" href="#parameters-of-interest"></a>
</h3>
<p>The counterfactual outcomes can be used to quantify the effect of
treatment in subgroups of patients with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
characteristics through the use of the Conditional Average Treatment
Effect (CATE). We define the CATE as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="script">ψ</mi><mrow><mo stretchy="true" form="prefix" mathvariant="script">(</mo><mi>𝓏</mi><mo stretchy="true" form="postfix" mathvariant="script">)</mo></mrow></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>Δ</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>Z</mi><mo>=</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>Δ</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>Z</mi><mo>=</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{\psi(z)} = E[Y(a = 1, \Delta = 1) | Z = z] - E[Y(a = 0, \Delta = 1) | Z = z]</annotation></semantics></math>.
The CATE is the expected difference in counterfactual outcome for
treatment vs placebo in a subgroup of patients with covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>.
If the outcome is binary,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi(Z)</annotation></semantics></math>
represents the causal risk difference in the sub-population with
covariate values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">Z=z</annotation></semantics></math>,
while if the outcome is continuous,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi(Z)</annotation></semantics></math>
represents the causal difference in expected outcome for the same
subpopulation.</p>
<p>Consider a decision rule
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
that assigns treatment to indiviuals based on their specific covariate
values. We wish to consider an <em>optimal</em> treatment rule such that
we assign treatment to all individuals who would benefit and to none who
would be harmed. To do this, we use the CATE to build our rule such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d(Z) = I(\psi(Z) &lt; 0)</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is an undesirable outcome and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d(Z) = I(\psi(Z) &gt; 0)</annotation></semantics></math>
if Y is a desirable outcome. We may further constrain these OTRs to only
recommend treatment to individuals with a CATE that reaches magnitude
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>t</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
d(Z) =
\begin{cases}
  0 &amp; \psi(Z) &lt; t \\
  1 &amp; \mbox{otherwise}
\end{cases}
</annotation></semantics></math> By constraining our OTR, we are able to
identify subgroups that would experience the greatest benefit under the
OTR, balancing benefits of treatment with potential resource
restrictions or limitations.</p>
</div>
<div class="section level3">
<h3 id="effect-estimands">Effect Estimands<a class="anchor" aria-label="anchor" href="#effect-estimands"></a>
</h3>
<p>We may use various effect estimands to quantify the impact of our
constrained OTR on the target population. We focus on the following:</p>
<ol style="list-style-type: decimal">
<li>
<em>Average Treatment effect among those Recommended Treatment by
rule d
</em>(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 1]</annotation></semantics></math>
</li>
<li>
<em>Average Treatment effect among those Not Recommended Treatment
by rule d
</em>(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATNRT_d</annotation></semantics></math>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 0]</annotation></semantics></math>
</li>
<li>
<em>Proportion Treated</em>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[d(Z) = 1]</annotation></semantics></math>
</li>
<li>
<em>Average Treatment effect under Rule d </em>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATR_d</annotation></semantics></math>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0)]</annotation></semantics></math>
</li>
<li>
<em>Difference between subgroups</em>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub><mo>−</mo><mi>A</mi><mi>T</mi><mi>R</mi><mi>N</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d - ATRNT_d</annotation></semantics></math>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 1] - E[Y(1) - Y(0) | d(Z) = 0]</annotation></semantics></math>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h3>
<p>Our approach makes use of nested cross-validation to estimate the
CATE. We partition the data into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
splits of approximately equal size to define the outer <em>K</em> folds.
The
<em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">k^{th}</annotation></semantics></math></em>
partition serves as the validation sample, while the remaining
<em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K - 1</annotation></semantics></math></em>
partitions serve as the training sample. The training samples are
partitioned further into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
splits to define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
inner folds, with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>v</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">v^{th}</annotation></semantics></math>
serving as the validation sample and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">V - 1</annotation></semantics></math>
serving as the training sample. We fix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">V = 3</annotation></semantics></math>
to ensure adequate sample size within each of the inner validation
folds. This nested cross-validation procedure helps to minimize risk of
overfitting when estimating the CATE.</p>
<p>Given a training sample, we follow the Doubly-robust (DR)-Learner
approach outlined in <span class="citation">(Kennedy 2023)</span>. Three
‘nuisance’ models used to build a pseudo-outcome: (1) an outcome model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>Δ</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>W</mi><mo>=</mo><mi>w</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mu(a,w) = E[Y | \Delta = 1, A = a, W = w]</annotation></semantics></math>,
a treatment model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="false" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo stretchy="false" form="prefix">|</mo><mi>W</mi><mo>=</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(a | w) = P(A = a | W = w)</annotation></semantics></math>,
and a missingness model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>W</mi><mo>=</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma(1 | a, w) = P(\Delta = 1 | A = a, W = w)</annotation></semantics></math>.
Super Learner is used to fit regressions for each of the nuisance
models. Given nuisance regression estimates, we define
pseudo-outcome</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>D</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><msub><mi>A</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Δ</mi><mi>i</mi></msub></mrow><mrow><msubsup><mover><mi>π</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msubsup><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>∣</mo><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow></mfrac><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>−</mo><msubsup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>+</mo><mo stretchy="false" form="prefix">{</mo><msubsup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msubsup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mspace width="0.222em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{D}_{k,v}^0(O_i) = \frac{(2A_i - 1)\Delta_i}{\hat{\pi}_{k,v}^0(A_i \mid W_i) \{ 1 - \hat{\gamma}_{k,v}^0(1 \mid A_i, W_i)\}} \{ Y_i - \hat{\mu}_{k,v}^0(A_i,W_i)\} + \{ \hat{\mu}_{k,v}^0(1, W_i) - \hat{\mu}_{k,v}^0(0, W_i)\} \ . 
</annotation></semantics></math> for each observation <em>i</em> in the
<em>v</em>-th validation sample nested in the <em>k</em>-th training
sample. We then fit a regression of the pseudo-outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>D</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{D}_{k,v}^0(O_i)</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
using data from teh
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>-th
validation sample, denoting the regression
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>ψ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>1</mn></msubsup><annotation encoding="application/x-tex">\hat{\psi}_{k,v}^1</annotation></semantics></math>.
The process repeats for each of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
inner cross-validation folds, resulting in CATE estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>ψ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>1</mn></msubsup><mo>:</mo><mi>v</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\hat{\psi}_{k,v}^1: v= 1, \dots, V)</annotation></semantics></math>
which can be averaged to obtain an estimate of the CATE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>ψ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>V</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></msubsup><msubsup><mover><mi>ψ</mi><mo accent="true">̂</mo></mover><mrow><mi>k</mi><mo>,</mo><mi>v</mi></mrow><mn>1</mn></msubsup></mrow><annotation encoding="application/x-tex">\hat{\psi}_{k}^0 = \frac{1}{V}\sum_{v=1}^V \hat{\psi}_{k,v}^1</annotation></semantics></math>.
We define our optimal treatment rule within the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
fold as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>d</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msubsup><mover><mi>ψ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>t</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow><mspace width="0.222em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{d}_{k}^0(Z) = \left\{ \begin{array}{cc}
   0 &amp; \mbox{if } \hat{\psi}_{k}^0(Z) &lt; t \\
   1  &amp; \mbox{otherwise}
\end{array}\right. \ .
</annotation></semantics></math></p>
<p>We can now use our decision rule learned from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
training sample to estimate our effect estimands of interest. Let us
identify the following quantities:</p>
<ul>
<li>The average outcome under treatment <em>a</em> given recommendation
of treatment <em>a’</em>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msubsup><mover><mi>d</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(a) \mid \hat{d}_{k}^0(Z) = a']</annotation></semantics></math>
identified via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>Δ</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>W</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msubsup><mover><mi>d</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(a \mid a') = E[E(Y \mid A = a, \Delta = 0, W) \mid \hat{d}_k^0(Z) = a']</annotation></semantics></math>
</li>
<li>The proportion treated under the rule:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><msubsup><mi>d</mi><mi>k</mi><mn>0</mn></msubsup><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_k = P(\hat{d_k^0}(Z) = 1)</annotation></semantics></math>
</li>
</ul>
<p>Using this notation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(1|1) - \theta_k(0|1)</annotation></semantics></math>
represents the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(1|0) - \theta_k(0|0)</annotation></semantics></math>
represents the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATNRT_d</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><msub><mi>p</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\{\theta_k(1|1) - \theta_k(0|1)\}p_k</annotation></semantics></math>
represents the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATR_d</annotation></semantics></math>.
We use augmented inverse probability of treatment weighted (AIPTW)
estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(a |a')</annotation></semantics></math>.
The forms of these estimators are given below. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup><annotation encoding="application/x-tex">\mathcal{I}_k^1</annotation></semantics></math>
denote a set containing the indices of observations in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
validation sample and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>n</mi><mi>k</mi><mn>1</mn></msubsup><annotation encoding="application/x-tex">n_k^1</annotation></semantics></math>
denote the cardinality of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup><annotation encoding="application/x-tex">\mathcal{I}_k^1</annotation></semantics></math>.
To estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_k</annotation></semantics></math>
we can use the estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>1</mn></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>n</mi><mi>k</mi><mn>1</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><mi>i</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow></msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{p}_k^1 = (n_k^1)^{-1}\sum_{i: i \in \mathcal{I}_k^1} I(d_k^0(Z_j) = 1)</annotation></semantics></math>.
To estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(a \mid a')</annotation></semantics></math>,
we define for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow><annotation encoding="application/x-tex">i \in \mathcal{I}_k^1</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mrow><mi>j</mi><mo>:</mo><mi>j</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow></munder><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mover><mi>π</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msubsup><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>∣</mo><mi>a</mi><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow></mfrac><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>−</mo><msubsup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>+</mo><msubsup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>0</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mspace width="0.222em"></mspace><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
T_i(a \mid a') &amp;= \frac{I(d_k^0(Z_i) = a')}{\sum_{j: j \in \mathcal{I}_k^1} I(d_k^0(Z_j) = a')} \left[ 
\frac{I(A_i = a, \Delta_i = 0)}{\hat{\pi}_k^0(a \mid W_i) \{1 - \hat{\gamma}_k^0(1 \mid a, W_i)\}} \{ Y_i - \hat{\mu}_{k}^0(a, W_i)\} + \hat{\mu}^0_k(a, W_i) \right] \ .
\end{align*}
</annotation></semantics></math> An augmented inverse probability of
treatment weighted (AIPTW) estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_k(a \mid a')</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>1</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>n</mi><mi>k</mi><mn>1</mn></msubsup></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><mi>i</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow></munder><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\theta}_k^1(a \mid a') = \frac{1}{n_{k}^1}  \sum_{i: i \in \mathcal{I}_k^1} T_i(a \mid a') 
</annotation></semantics></math> The asymptotic variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>1</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">n^{1/2} \hat{\theta}_k^1(a \mid a')</annotation></semantics></math>
can be estimated using
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>k</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>n</mi><mi>k</mi><mn>1</mn></msubsup></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><mi>i</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow></munder><msup><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>:</mo><mi>j</mi><mo>∈</mo><msubsup><mi>ℐ</mi><mi>k</mi><mn>1</mn></msubsup></mrow><mi>n</mi></munderover><msub><mi>T</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>∣</mo><mi>a</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mn>2</mn></msup><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">
\hat{\sigma}^2_k = \frac{1}{n_{k}^1}  \sum_{i: i \in \mathcal{I}_k^1} \left\{ T_i(a \mid a') - \sum_{j: j \in \mathcal{I}_k^1}^n T_j(a \mid a') \right\}^2 \ 
</annotation></semantics></math> The delta method for influence
functions can be used to compute estimates of the asymptotic variance of
scaled estimates of the effect parameters.</p>
<p>We estimate the parameters in each outer cross-validation fold, then
average them across folds to obtain overall estimates. A flowchart
depicting the overall estimation procedure can be seen in the figure
below.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage:<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>First, load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/allicodi/drotr" class="external-link">drotr</a></span><span class="op">)</span></span></code></pre></div>
<p>The following example uses a toy data set (<code>abcd_data</code>)
that comes with the package. <code>abcd_data</code> is a simulated
dataset based on real data from the AntiBiotics for Children with severe
Diarrhea (ABCD) trial. The dataset contains 40 covariates
(<code>W</code>) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>6692</mn></mrow><annotation encoding="application/x-tex">n = 6692</annotation></semantics></math>
observations.
<!--- Refer to **include data dictionary? or refer to supplement? but not sure if we're publishing this first ** for a data dictionary and description of the data generation process. ---></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">abcd_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">abcd_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   pid an_grp_01 rotavirus_new norovirus_new adenovirus_new astrovirus_new</span></span>
<span><span class="co">#&gt; 1   1         0             0      0.000000       0.000000              0</span></span>
<span><span class="co">#&gt; 2   2         0             0      0.000000       0.000000              0</span></span>
<span><span class="co">#&gt; 3   3         0             0      0.000000       0.000000              0</span></span>
<span><span class="co">#&gt; 4   4         0             0      4.301341       1.413699              0</span></span>
<span><span class="co">#&gt; 5   5         1             0      0.000000       0.000000              0</span></span>
<span><span class="co">#&gt; 6   6         1             0      0.000000       4.613438              0</span></span>
<span><span class="co">#&gt;   sapovirus_new st_etec_new shigella_new campylobacter_new tepec_new</span></span>
<span><span class="co">#&gt; 1      5.809444   0.0000000     1.975475         0.9374672  0.000000</span></span>
<span><span class="co">#&gt; 2      0.000000   1.0992149     0.000000         0.0000000  3.197217</span></span>
<span><span class="co">#&gt; 3      0.000000   1.2516375     0.000000         0.0000000  0.000000</span></span>
<span><span class="co">#&gt; 4      0.000000   0.0000000     0.000000         0.0000000  0.000000</span></span>
<span><span class="co">#&gt; 5      0.000000   0.2018044     0.000000         3.0005416  0.000000</span></span>
<span><span class="co">#&gt; 6      0.000000   0.0000000     0.000000         0.0000000  0.000000</span></span>
<span><span class="co">#&gt;   v_cholerae_new salmonella_new cryptosporidium_new rotavirus_bin norovirus_bin</span></span>
<span><span class="co">#&gt; 1              0              0                   0             0             0</span></span>
<span><span class="co">#&gt; 2              0              0                   0             0             0</span></span>
<span><span class="co">#&gt; 3              0              0                   0             0             0</span></span>
<span><span class="co">#&gt; 4              0              0                   0             0             1</span></span>
<span><span class="co">#&gt; 5              0              0                   0             0             0</span></span>
<span><span class="co">#&gt; 6              0              0                   0             0             0</span></span>
<span><span class="co">#&gt;   adenovirus_bin astrovirus_bin sapovirus_bin st_etec_bin shigella_bin</span></span>
<span><span class="co">#&gt; 1              0              0             1           0            1</span></span>
<span><span class="co">#&gt; 2              0              0             0           1            0</span></span>
<span><span class="co">#&gt; 3              0              0             0           1            0</span></span>
<span><span class="co">#&gt; 4              1              0             0           0            0</span></span>
<span><span class="co">#&gt; 5              0              0             0           1            0</span></span>
<span><span class="co">#&gt; 6              1              0             0           0            0</span></span>
<span><span class="co">#&gt;   campylobacter_bin tepec_bin v_cholerae_bin salmonella_bin cryptosporidium_bin</span></span>
<span><span class="co">#&gt; 1                 1         0              0              0                   0</span></span>
<span><span class="co">#&gt; 2                 0         1              0              0                   0</span></span>
<span><span class="co">#&gt; 3                 0         0              0              0                   0</span></span>
<span><span class="co">#&gt; 4                 0         0              0              0                   0</span></span>
<span><span class="co">#&gt; 5                 1         0              0              0                   0</span></span>
<span><span class="co">#&gt; 6                 0         0              0              0                   0</span></span>
<span><span class="co">#&gt;   dy1_scrn_vomitall dy1_scrn_lstools dy1_scrn_sstools dy1_scrn_diardays</span></span>
<span><span class="co">#&gt; 1               Yes                9                1                 0</span></span>
<span><span class="co">#&gt; 2               Yes                7                0                 1</span></span>
<span><span class="co">#&gt; 3               Yes                7                0                 5</span></span>
<span><span class="co">#&gt; 4               Yes                7                0                 2</span></span>
<span><span class="co">#&gt; 5               Yes                1                0                 1</span></span>
<span><span class="co">#&gt; 6               Yes                5                0                 2</span></span>
<span><span class="co">#&gt;      dy1_scrn_dehydr     site dy1_ant_sex agemchild     an_ses_quintile</span></span>
<span><span class="co">#&gt; 1   Some dehydration Pakistan      Female  5.801993 4th quintile of SES</span></span>
<span><span class="co">#&gt; 2   Some dehydration Pakistan      Female 14.681659 5th quintile of SES</span></span>
<span><span class="co">#&gt; 3 Severe dehydration Tanzania      Female  7.558416 3rd quintile of SES</span></span>
<span><span class="co">#&gt; 4   Some dehydration   Malawi        Male 13.743810 4th quintile of SES</span></span>
<span><span class="co">#&gt; 5     No dehydration     Mali      Female  9.848812 3rd quintile of SES</span></span>
<span><span class="co">#&gt; 6     No dehydration    Kenya        Male  9.799398 1st quintile of SES</span></span>
<span><span class="co">#&gt;   an_tothhlt5  month_en rotaseason  avemuac  lfazscore  wfazscore  wflzscore</span></span>
<span><span class="co">#&gt; 1           3      July          0 12.43363  0.9887319 -0.6014197 -0.8977421</span></span>
<span><span class="co">#&gt; 2           1      June          1 11.37052 -3.3641961 -3.8697283 -2.2103208</span></span>
<span><span class="co">#&gt; 3           2 September          1 13.50581 -0.7048566 -1.6076714 -1.4870581</span></span>
<span><span class="co">#&gt; 4           4   January          0 12.63497 -1.9954476 -2.1567078 -0.7570579</span></span>
<span><span class="co">#&gt; 5           2   January          1 13.94833 -0.1411175 -0.7486380 -0.8417239</span></span>
<span><span class="co">#&gt; 6           3     March          0 14.19664 -1.3049425 -0.6480911  0.5913560</span></span>
<span><span class="co">#&gt;        lazd90</span></span>
<span><span class="co">#&gt; 1 -0.24423622</span></span>
<span><span class="co">#&gt; 2 -3.24702621</span></span>
<span><span class="co">#&gt; 3 -0.05373623</span></span>
<span><span class="co">#&gt; 4 -2.17004791</span></span>
<span><span class="co">#&gt; 5  0.17351546</span></span>
<span><span class="co">#&gt; 6 -2.21432910</span></span></code></pre></div>
<p>We aim to simulate the effect of azithromycin
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>a</mi><mi>n</mi><mi>_</mi><mi>g</mi><mi>r</mi><mi>p</mi><mi>_</mi><mn>01</mn></mrow><annotation encoding="application/x-tex">A = an\_grp\_01</annotation></semantics></math>),
an antibiotic commonly used against diarrheal pathogens, on linear
growth 90 days after trial enrollment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>l</mi><mi>a</mi><mi>z</mi><mi>d</mi><mn>90</mn></mrow><annotation encoding="application/x-tex">Y = lazd90</annotation></semantics></math>).
Approximately 4% of outcomes <code>Y</code> are missing at random. We
want to estimate an OTR based on a subset of covariates related to host
characteristics measured at baseline
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mi>m</mi><mi>u</mi><mi>a</mi><mi>c</mi><mo>,</mo><mi>w</mi><mi>f</mi><mi>a</mi><mi>z</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>,</mo><mi>w</mi><mi>f</mi><mi>l</mi><mi>z</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>,</mo><mi>l</mi><mi>f</mi><mi>a</mi><mi>z</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>,</mo><mi>d</mi><mi>y</mi><mn>1</mn><mi>_</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>_</mi><mi>s</mi><mi>e</mi><mi>x</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>e</mi><mi>m</mi><mi>c</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mo>,</mo><mi>a</mi><mi>n</mi><mi>_</mi><mi>s</mi><mi>e</mi><mi>s</mi><mi>_</mi><mi>q</mi><mi>u</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Z = avemuac, wfazscore, wflzscore, lfazscore, dy1\_ant\_sex, agemchild, an\_ses\_quintile</annotation></semantics></math>).
We test a threshold of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">t = 0.05</annotation></semantics></math>
for treatment. That means patients will only be recommended treatment if
they are expected to have benefit in linear growth at day 90 of the
trial of 0.05 z-score or more compared to if they did not receive
treatment.</p>
<p>Note in this example, outcome is beneficial. CATEs exceeding the
threshold are desirable and indicate high benefit from treatment. If the
outcome were undesirable, we would want individuals with CATEs that are
have a larger negative magnitude than the threshold to be recommended
treatment. The package will automatically adjust for this when setting a
negative threshold. However, if using a threshold of zero, make sure to
enter “+0” or “-0” as a character string to indicate direction.</p>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>Let’s set the parameters described above to be passed into the
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"lazd90"</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="st">"an_grp_01"</span></span>
<span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rotavirus_new"</span>, <span class="st">"rotavirus_bin"</span>, <span class="st">"norovirus_new"</span>, <span class="st">"norovirus_bin"</span>, <span class="st">"adenovirus_new"</span>,</span>
<span>      <span class="st">"adenovirus_bin"</span>, <span class="st">"sapovirus_new"</span>,<span class="st">"sapovirus_bin"</span>, <span class="st">"astrovirus_new"</span>, <span class="st">"astrovirus_bin"</span>,</span>
<span>      <span class="st">"st_etec_new"</span>, <span class="st">"st_etec_bin"</span>, <span class="st">"shigella_new"</span>, <span class="st">"shigella_bin"</span>, <span class="st">"campylobacter_new"</span>,</span>
<span>      <span class="st">"campylobacter_bin"</span>, <span class="st">"tepec_new"</span>, <span class="st">"tepec_bin"</span>, <span class="st">"v_cholerae_new"</span>, <span class="st">"v_cholerae_bin"</span>,</span>
<span>      <span class="st">"salmonella_new"</span>, <span class="st">"salmonella_bin"</span>, <span class="st">"cryptosporidium_new"</span>, <span class="st">"cryptosporidium_bin"</span>,</span>
<span>      <span class="st">"dy1_scrn_vomitall"</span>, <span class="st">"dy1_scrn_lstools"</span>, <span class="st">"dy1_scrn_sstools"</span>, <span class="st">"dy1_scrn_diardays"</span>,</span>
<span>      <span class="st">"dy1_scrn_dehydr"</span>, <span class="st">"avemuac"</span>, <span class="st">"wfazscore"</span>, <span class="st">"lfazscore"</span>, <span class="st">"wflzscore"</span>, <span class="st">"site"</span>,</span>
<span>      <span class="st">"dy1_ant_sex"</span>, <span class="st">"agemchild"</span>, <span class="st">"an_ses_quintile"</span>, <span class="st">"an_tothhlt5"</span>, <span class="st">"month_en"</span>, <span class="st">"rotaseason"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avemuac"</span>, <span class="st">"wfazscore"</span>, <span class="st">"wflzscore"</span>, <span class="st">"lfazscore"</span>, <span class="st">"dy1_ant_sex"</span>, <span class="st">"agemchild"</span>, <span class="st">"an_ses_quintile"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<p>Next, we need to choose which libraries we are interested in using to
fit our nuisance models. The SuperLearner package comes with wrappers
for common prediction algorithms (see
<code><a href="https://rdrr.io/pkg/SuperLearner/man/listWrappers.html" class="external-link">SuperLearner::listWrappers()</a></code> for full list of available
wrappers). We will choose several for our outcome model that should be
able to capture the complex form of the outcome model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl.library.outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SL.glm"</span>, <span class="st">"SL.ranger"</span>, <span class="st">"SL.earth"</span><span class="op">)</span></span></code></pre></div>
<p>We know the ABCD trial was a randomized control trial, so
<code>SL.mean</code> should be sufficient to estimate the 1:1
randomization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl.library.treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SL.mean"</span><span class="op">)</span></span></code></pre></div>
<p>Additionally, one may wish to write their own wrappers for
SuperLearner based on biological plausibility. In the simulated dataset,
we know data is missing at random. However, one may hypothesize that the
data is missing based on the variables month and site. We can specify a
missingness model using these covariates as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SL.missing.1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">newX</span>, <span class="va">family</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sl.missing.1_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">site</span> <span class="op">+</span> <span class="va">month_en</span>,</span>
<span>                          data <span class="op">=</span> <span class="va">X</span>,</span>
<span>                          family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span>
<span>  <span class="co"># get predictions on newX</span></span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">sl.missing.1_fit</span>, newdata <span class="op">=</span> <span class="va">newX</span>, type <span class="op">=</span> <span class="st">'response'</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># format the output as named list</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fitted_model.missing.1 <span class="op">=</span> <span class="va">sl.missing.1_fit</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, pred <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span>
<span>  <span class="co"># give the object a class</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SL.missing.1"</span></span>
<span>  <span class="co"># return the output</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">predict.SL.missing.1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">fitted_model.missing.1</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We will include this new wrapper in our list of missingness
models</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl.library.missingness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SL.mean"</span>, <span class="st">"SL.missing.1"</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we must specify CATE models that are sufficiently complex to
capture the true treatment effect.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl.library.CATE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SL.glm"</span>, <span class="st">"SL.ranger"</span>, <span class="st">"SL.earth"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-otr">Estimate OTR<a class="anchor" aria-label="anchor" href="#estimate-otr"></a>
</h3>
<p>To run the analysis, we call <code><a href="../reference/estimate_OTR.html">estimate_OTR()</a></code> with the
parameters specified above. In addition, we specify the name of the id
variable in the dataset (<code>pid</code>), the number of folds used in
outer cross-validation (<code>k = 10</code>), and indicate that the
outcome is continuous (<code>gaussian</code>). (Note the run-time of the
chunk below is approximately 4 minutes using libraries specified
above).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_host</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_OTR.html">estimate_OTR</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">abcd_data</span>,</span>
<span>                             Y_name <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                             A_name <span class="op">=</span> <span class="va">A</span>, </span>
<span>                             W_list <span class="op">=</span> <span class="va">W</span>, </span>
<span>                             Z_list <span class="op">=</span> <span class="va">Z</span>, </span>
<span>                             id_name <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                             sl.library.outcome <span class="op">=</span> <span class="va">sl.library.outcome</span>,</span>
<span>                             sl.library.treatment <span class="op">=</span> <span class="va">sl.library.treatment</span>,</span>
<span>                             sl.library.missingness <span class="op">=</span> <span class="va">sl.library.missingness</span>,</span>
<span>                             sl.library.CATE <span class="op">=</span> <span class="va">sl.library.CATE</span>,</span>
<span>                             threshold <span class="op">=</span> <span class="va">t</span>,</span>
<span>                             k_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                             outcome_type <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, we may choose to break this up into two steps- (1) for
nuisance model estimation, and (2) for estimation of effects. This can
be helpful to split up time-consuming analyses that use the same set of
nuisance models repeatedly. To do this, start by calling the
<code>learn_nuisance</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nuisance_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/learn_nuisance.html">learn_nuisance</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">abcd_data</span>,</span>
<span>                                  Y_name <span class="op">=</span> <span class="va">Y</span>,</span>
<span>                                  A_name <span class="op">=</span> <span class="va">A</span>, </span>
<span>                                  W_list <span class="op">=</span> <span class="va">W</span>,</span>
<span>                                  sl.library.outcome <span class="op">=</span> <span class="va">sl.library.outcome</span>,</span>
<span>                                  sl.library.treatment <span class="op">=</span> <span class="va">sl.library.treatment</span>,</span>
<span>                                  sl.library.missingness <span class="op">=</span> <span class="va">sl.library.missingness</span>,</span>
<span>                                  k_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                  outcome_type <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nnls</span></span>
<span><span class="co">#&gt; Loading required namespace: earth</span></span>
<span><span class="co">#&gt; Loading required namespace: ranger</span></span></code></pre></div>
<p>This will return an object of class <code>nuisance</code> which
contains model fits (<code>nuisance_models</code>), outer validation
fold assignments and pseudo-outcomes
(<code>k_fold_assign_and_CATE</code>), and inner validation fold
assignments (<code>validRows</code>). These can be passed into
<code>estimate_OTR</code> and avoid unnecessary re-fitting of
models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nuisance_models</span> <span class="op">&lt;-</span> <span class="va">nuisance_output</span><span class="op">$</span><span class="va">nuisance_models</span></span>
<span><span class="va">k_fold_assign_and_CATE</span> <span class="op">&lt;-</span> <span class="va">nuisance_output</span><span class="op">$</span><span class="va">k_fold_assign_and_CATE</span></span>
<span><span class="va">validRows</span> <span class="op">&lt;-</span> <span class="va">nuisance_output</span><span class="op">$</span><span class="va">validRows</span></span>
<span></span>
<span><span class="va">results_host</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_OTR.html">estimate_OTR</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">abcd_data</span>,</span>
<span>                             Y_name <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                             A_name <span class="op">=</span> <span class="va">A</span>, </span>
<span>                             W_list <span class="op">=</span> <span class="va">W</span>, </span>
<span>                             Z_list <span class="op">=</span> <span class="va">Z</span>, </span>
<span>                             id_name <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                             sl.library.CATE <span class="op">=</span> <span class="va">sl.library.CATE</span>,</span>
<span>                             nuisance_models <span class="op">=</span> <span class="va">nuisance_models</span>,</span>
<span>                             k_fold_assign_and_CATE <span class="op">=</span> <span class="va">k_fold_assign_and_CATE</span>,</span>
<span>                             validRows <span class="op">=</span> <span class="va">validRows</span>,</span>
<span>                             threshold <span class="op">=</span> <span class="va">t</span>,</span>
<span>                             k_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                             outcome_type <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></code></pre></div>
<p>Once we have obtained results, we can print them in a table to
console using <code>print</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_host</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                Results for  threshold =  0.05  Aggregated Across k =  10  folds </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt;                                                             Estimate            Standard Error      95% CI: Lower       95% CI: Upper       </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt; E[Y(1) | d(Z) = 1]                                          -1.5367             0.0426              -1.6202             -1.4533             </span></span>
<span><span class="co">#&gt; E[Y(0) | d(Z) = 1]                                          -1.5572             0.0431              -1.6417             -1.4728             </span></span>
<span><span class="co">#&gt; E[d(Z) = 1]                                                 0.3753              0.0057              0.3642              0.3864              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1]                                   0.0205              0.0397              -0.0573             0.0983              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 0]                                   0.052               0.0182              0.0164              0.0877              </span></span>
<span><span class="co">#&gt; E[Y(d) - Y(0)]                                              0.0062              0.0086              -0.0107             0.0231              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1] - E[Y(1) - Y(0) | d(Z) = 0]       -0.0315             0.0437              -0.1172             0.0541              </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariates used in decision rule:  avemuac, wfazscore, wflzscore, lfazscore, dy1_ant_sex, agemchild, an_ses_quintile</span></span></code></pre></div>
<p>We can interpret the results as follows:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) | d(Z) = 1]</annotation></semantics></math>:
The expected length-for-age z-score at day 90 of the trial for children
who are recommended treatment under the host OTR and receive treatment
is -1.65 (95% CI: -1.70 to -1.60).</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(0) | d(Z) = 1]</annotation></semantics></math>:
The expected length-for-age z-score at day 90 of the trial for children
who are recommended treatment under the host OTR but do not receive
treatment is -1.72 (95% CI: -1.77 to -1.66).</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[d(Z) = 1]</annotation></semantics></math>:
The percentage of children recommended treatment under the host OTR is
42.92% (95% CI: 41.73% to 44.10%)</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 1]</annotation></semantics></math>
/
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>:
The average treatment effect among those recommended treatment under the
host OTR is 0.07 (95% CI: 0.03 to 0.11). Children who are recommended
treatment under the rule and receive it will have a length-for-age
z-score that is 0.07 higher than if they had not received treatment.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 0]</annotation></semantics></math>
/
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>N</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATNRT_d</annotation></semantics></math>:
The average treatment effect among those <em>not</em> recommended
treatment under the host OTR is 0.02 (95% CI: -0.02 to 0.05). Children
who are <em>not</em> recommended treatment under the rule yet still
receive it would have a length-for-age z-score that is 0.02 higher than
their z-score without receiving treatment.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(d) - Y(0)]</annotation></semantics></math>
/
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATR_d</annotation></semantics></math>:
The overall average treatment effect of the rule is 0.03 (95% CI: 0.01
to 0.05). At a population level, implementation of the treatment rule
improves length-for-age z-scores at day 90 of the trial by 0.03.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y(1) - Y(0) | d(Z) = 1] - E[Y(1) - Y(0) | d(Z) = 0]</annotation></semantics></math>
: The difference in treatment effect between the treated and untreated
subgroups is 0.05 (95% CI: 0.00 to 0.11)</p>
<p>One may wish to examine other output in the final
<code>full_otr_results</code> object. The <code>full_otr_results</code>
contains the following elements:</p>
<ul>
<li>
<p><strong><code>results</code> (class
<code>otr_results</code>)</strong><br>
This component contains results for various thresholds, each represented
as a separate <code>Results</code> object.</p>
<ul>
<li>
<strong><code>threshold = t1</code> (Results object)</strong>
<ul>
<li>
<code>aggregated_results</code>: Summary results across k CATE
models</li>
<li>
<code>k_fold_results</code>: Results and influence functions from
each of the k-folds</li>
<li>
<code>decision_df</code>: Data frame containing CATE prediction and
decision for each observation</li>
<li>
<code>k_non_na</code>: Folds that did not result in proportion
treated = 1 or 0 (leading to NA effect estimates)</li>
</ul>
</li>
<li>
<strong><code>threshold = t2</code> (Results object)</strong>
<ul>
<li>Same structure as <code>threshold = t1</code> if additional
threshold(s) specified</li>
</ul>
</li>
<li>
<strong><code>...</code></strong>
<ul>
<li>Additional thresholds can be added in the same manner.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>nuisance_models</code></strong><br>
A list of nuisance models used in the analysis.</p>
<ul>
<li>
<strong><code>fold 1</code> (Nuisance object)</strong>
<ul>
<li>
<code>outcome_model</code>: Model for outcome.</li>
<li>
<code>treatment_model</code>: Model for the treatment.</li>
<li>
<code>missingness_model</code>: Model for missing data.</li>
</ul>
</li>
<li>
<strong><code>fold 2</code> (Nuisance object)</strong>
<ul>
<li>Structure similar to <code>fold 1</code>.</li>
</ul>
</li>
<li>
<strong><code>...</code></strong>
<ul>
<li>Up to K nuisance models</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>CATE_models</code></strong><br>
A list of CATE models generated during the analysis.</p>
<ul>
<li>
<strong><code>fold 1</code></strong>: CATE model results for fold
1.</li>
<li>
<strong><code>fold 2</code></strong>: CATE model results for fold
2.</li>
<li>
<strong><code>...</code></strong>: Up to k CATE models</li>
</ul>
</li>
<li><p><strong><code>Z_list</code></strong><br>
List of covariates used for CATE model</p></li>
</ul>
<p>Note- results objects may become very large depending on the
libraries used in model fitting. One could opt to save the
<code>otr_results</code> object rather than the
<code>full_otr_results</code> to conserve memory and maintain output
printing functionality.</p>
</div>
<div class="section level3">
<h3 id="compare-otrs">Compare OTRs<a class="anchor" aria-label="anchor" href="#compare-otrs"></a>
</h3>
<p>We may be interested in comparing results and making inference about
them across different rules. Let’s consider another OTR based on
<em>Shigella</em> pathogen quantity.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shigella_new"</span>, <span class="st">"shigella_bin"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_shigella</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_OTR.html">estimate_OTR</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">abcd_data</span>,</span>
<span>                             Y_name <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                             A_name <span class="op">=</span> <span class="va">A</span>, </span>
<span>                             W_list <span class="op">=</span> <span class="va">W</span>, </span>
<span>                             Z_list <span class="op">=</span> <span class="va">Z</span>, </span>
<span>                             id_name <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                             sl.library.outcome <span class="op">=</span> <span class="va">sl.library.outcome</span>,</span>
<span>                             sl.library.treatment <span class="op">=</span> <span class="va">sl.library.treatment</span>,</span>
<span>                             sl.library.missingness <span class="op">=</span> <span class="va">sl.library.missingness</span>,</span>
<span>                             sl.library.CATE <span class="op">=</span> <span class="va">sl.library.CATE</span>,</span>
<span>                             threshold <span class="op">=</span> <span class="va">t</span>,</span>
<span>                             k_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                             outcome_type <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_shigella</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                Results for  threshold =  0.05  Aggregated Across k =  10  folds </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt;                                                             Estimate            Standard Error      95% CI: Lower       95% CI: Upper       </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt; E[Y(1) | d(Z) = 1]                                          -1.5163             0.0397              -1.594              -1.4386             </span></span>
<span><span class="co">#&gt; E[Y(0) | d(Z) = 1]                                          -1.7533             0.0388              -1.8292             -1.6773             </span></span>
<span><span class="co">#&gt; E[d(Z) = 1]                                                 0.1905              0.0048              0.1811              0.1999              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1]                                   0.237               0.0328              0.1727              0.3013              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 0]                                   -0.005              0.0156              -0.0357             0.0256              </span></span>
<span><span class="co">#&gt; E[Y(d) - Y(0)]                                              0.0448              0.0066              0.032               0.0577              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1] - E[Y(1) - Y(0) | d(Z) = 0]       0.242               0.0363              0.1708              0.3132              </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariates used in decision rule:  shigella_new, shigella_bin</span></span></code></pre></div>
<p>We can compare the average treatment effect among those recommended
treatment under the rule
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>,
subgroup effect) across rules by calling the
<code>compare.otr_results</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare.otr_results.html">compare.otr_results</a></span><span class="op">(</span>res_rule1 <span class="op">=</span> <span class="va">results_host</span>,</span>
<span>                    res_rule2 <span class="op">=</span> <span class="va">results_shigella</span>,</span>
<span>                    threshold <span class="op">=</span> <span class="va">t</span>, </span>
<span>                    rule1_comp <span class="op">=</span> <span class="st">"se"</span>,</span>
<span>                    rule2_comp <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Subgroup Effect E[Y(d) - Y(0) | d(Z) = 1]  for rule 1 at threshold =  0.05 </span></span>
<span><span class="co">#&gt;  vs </span></span>
<span><span class="co">#&gt;  Subgroup Effect E[Y(d) - Y(0) | d(Z) = 1]  for rule 2 at threshold =  0.05 </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt;                               Estimate            Standard Error      95% CI: Lower       95% CI: Upper       </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt; Rule 1 - Rule 2               -0.2165             0.0514              -0.3172             -0.1158             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rule 1: Z =  avemuac, wfazscore, wflzscore, lfazscore, dy1_ant_sex, agemchild, an_ses_quintile</span></span>
<span><span class="co">#&gt;  Rule 2: Z =  shigella_new, shigella_bin</span></span></code></pre></div>
<p>The difference in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>R</mi><msub><mi>T</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">ATRT_d</annotation></semantics></math>
between the host and <em>Shigella</em> rules is -0.17 (95% CI: -0.25 to
-0.09). The subgroup that is treated using a rule based on
<em>Shigella</em> will have an average z-score that is 0.17 higher at
day 90 than the average z-score of the subgroup that is treated using a
rule based on host characteristics. A rule based on Shigella may be more
effective at improving length-for-age z-score at day 90 than a rule
based on host characteristics using a threshold of 0.05.</p>
</div>
</div>
<div class="section level2">
<h2 id="average-results-across-seeds">Average results across seeds<a class="anchor" aria-label="anchor" href="#average-results-across-seeds"></a>
</h2>
<p>One may be interested in running multiple simulations for a set rule
and averaging the results to account for random variability in the model
fitting. The <code>average_across_seeds</code> function may be used to
average the results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">seed</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">results_shigella</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_OTR.html">estimate_OTR</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">abcd_data</span>,</span>
<span>                                   Y_name <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                                   A_name <span class="op">=</span> <span class="va">A</span>, </span>
<span>                                   W_list <span class="op">=</span> <span class="va">W</span>, </span>
<span>                                   Z_list <span class="op">=</span> <span class="va">Z</span>, </span>
<span>                                   id_name <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                                   sl.library.outcome <span class="op">=</span> <span class="va">sl.library.outcome</span>,</span>
<span>                                   sl.library.treatment <span class="op">=</span> <span class="va">sl.library.treatment</span>,</span>
<span>                                   sl.library.missingness <span class="op">=</span> <span class="va">sl.library.missingness</span>,</span>
<span>                                   sl.library.CATE <span class="op">=</span> <span class="va">sl.library.CATE</span>,</span>
<span>                                   threshold <span class="op">=</span> <span class="va">t</span>,</span>
<span>                                   k_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                   outcome_type <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="va">seed</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">results_shigella</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/average_across_seeds.html">average_across_seeds</a></span><span class="op">(</span>results_list <span class="op">=</span> <span class="va">results_list</span>, threshold <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                         Average results across n =  3  seeds for threshold  0.05 </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt;                                                             Estimate            Standard Error      95% CI: Lower       95% CI: Upper       </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt; E[Y(1) | d(Z) = 1]                                          -1.515              0.0397              -1.5929             -1.4372             </span></span>
<span><span class="co">#&gt; E[Y(0) | d(Z) = 1]                                          -1.7506             0.039               -1.8271             -1.6742             </span></span>
<span><span class="co">#&gt; E[d(Z) = 1]                                                 0.1908              0.0048              0.1814              0.2002              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1]                                   0.2356              0.0328              0.1713              0.2999              </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 0]                                   -0.0062             0.0156              -0.0369             0.0244              </span></span>
<span><span class="co">#&gt; E[Y(d) - Y(0)]                                              0.0451              0.0066              0.0323              0.058               </span></span>
<span><span class="co">#&gt; E[Y(1) - Y(0) | d(Z) = 1] - E[Y(1) - Y(0) | d(Z) = 0]       0.2418              0.0363              0.1706              0.313               </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariates used in decision rule:  shigella_new, shigella_bin</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] nnls_1.5    drotr_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.3           knitr_1.48          rlang_1.1.4        </span></span>
<span><span class="co">#&gt;  [4] xfun_0.48           Formula_1.2-5       textshaping_0.4.0  </span></span>
<span><span class="co">#&gt;  [7] SuperLearner_2.0-29 jsonlite_1.8.9      ranger_0.16.0      </span></span>
<span><span class="co">#&gt; [10] htmltools_0.5.8.1   ragg_1.3.3          sass_0.4.9         </span></span>
<span><span class="co">#&gt; [13] rmarkdown_2.28      grid_4.4.1          evaluate_1.0.1     </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4     earth_5.3.4         fastmap_1.2.0      </span></span>
<span><span class="co">#&gt; [19] yaml_2.3.10         foreach_1.5.2       lifecycle_1.0.4    </span></span>
<span><span class="co">#&gt; [22] compiler_4.4.1      codetools_0.2-20    fs_1.6.4           </span></span>
<span><span class="co">#&gt; [25] Rcpp_1.0.13         lattice_0.22-6      systemfonts_1.1.0  </span></span>
<span><span class="co">#&gt; [28] digest_0.6.37       R6_2.5.1            splines_4.4.1      </span></span>
<span><span class="co">#&gt; [31] gam_1.22-5          Matrix_1.7-0        bslib_0.8.0        </span></span>
<span><span class="co">#&gt; [34] plotmo_3.6.4        tools_4.4.1         plotrix_3.8-4      </span></span>
<span><span class="co">#&gt; [37] iterators_1.0.14    pkgdown_2.1.1       cachem_1.1.0       </span></span>
<span><span class="co">#&gt; [40] desc_1.4.3</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-kennedy_towards_2023" class="csl-entry">
Kennedy, Edward H. 2023. <span>“Towards Optimal Doubly Robust Estimation
of Heterogeneous Causal Effects.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2004.14497" class="external-link">https://doi.org/10.48550/arXiv.2004.14497</a>.
</div>
<div id="ref-kurz_aiptw_2022" class="csl-entry">
Kurz, C. F. 2022. <span>“Augmented Inverse Probability Weighting and the
Double Robustness Property.”</span> <em>Medical Decision Making: An
International Journal of the Society for Medical Decision Making</em> 42
(2): 156–67. <a href="https://doi.org/10.1177/0272989X211027181" class="external-link">https://doi.org/10.1177/0272989X211027181</a>.
</div>
<div id="ref-luedtke_super-learning_2016" class="csl-entry">
Luedtke, Alexander R., and Mark J. van der Laan. 2016.
<span>“Super-<span>Learning</span> of an <span>Optimal</span>
<span>Dynamic</span> <span>Treatment</span> <span>Rule</span>.”</span>
<em>The International Journal of Biostatistics</em> 12 (1): 305. <a href="https://doi.org/10.1515/ijb-2015-0052" class="external-link">https://doi.org/10.1515/ijb-2015-0052</a>.
</div>
<div id="ref-montoya_optimal_2023" class="csl-entry">
Montoya, Lina M., Mark J. van der Laan, Alexander R. Luedtke, Jennifer
L. Skeem, Jeremy R. Coyle, and Maya L. Petersen. 2023. <span>“The
Optimal Dynamic Treatment Rule Superlearner: Considerations,
Performance, and Application to Criminal Justice Interventions.”</span>
<em>The International Journal of Biostatistics</em> 19 (1): 217–38. <a href="https://doi.org/10.1515/ijb-2020-0127" class="external-link">https://doi.org/10.1515/ijb-2020-0127</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Allison Codi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
